# 22.05 / 유저 몰리는 시간에 서비스 속도 저하

### 이슈

유저가 몰리는 시간에 서비스 속도 저하가 심함

### 원인

![리소스 감시 Whatap](https://user-images.githubusercontent.com/59993347/176369173-445c6d38-3379-4308-9c7c-55ed246aa5d5.png)

원인은 이미지 API 앱과 일반적인 동적 페이지 생성 앱이 한 서버에 같이 구동중이었는데, 이미지 API가 작동에 들어가면, 서버 cpu 리소스를 있는대로 다 끌어다 써서, **다른 부가적인 웹서비스에도 영향을 미치는 것**이었다. 단순 접속조차 버벅일 뿐만 아니라, 공지사항 읽기, 사용법 등 모든 것이 느려졌다.

### 해결

이 당시 오라클 클라우드 서버가 2대가 주어져 있었고, 서버 한대는 젠킨스를 이용한 배포 서버, 한 대는 운영 서버로 사용 중 이었다.

내 결정은 젠킨스 배포 서버를 없애고, 그곳에 이미지 API 서버를 구동시키는 것이었다. 서버 스펙 업을 위해 추가 과금할 정도의 수익 모델은 없기 때문에, **무료로 주어진 2개의 서버를 최대한 활용하자는 취지**였다.

젠킨스를 대신해서 Github Action을 통해 다시 빌드, 배포 시스템을 구축하였고, nginx를 통해 두 서버를 유기적으로 연결시켜 주었다.

### 배운점

* 각각의 앱에는 필요한 양의 자원이 보장되어야 함
* 한 앱의 작동이 다른 앱의 작동에 영향을 끼치면 곤란함
* 이를 한 개의 서버 내에서 해결하려면?
  * 도커를 많이 사용한다고 함
  * 컨테이너 별로 리소스 세부 조절이 가능
